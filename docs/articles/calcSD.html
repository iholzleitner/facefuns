<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate sexual dimorphism of faces • facefuns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calculate sexual dimorphism of faces">
<meta property="og:description" content="facefuns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">facefuns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/facefuns.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calcSD.html">Calculate sexual dimorphism of faces</a>
    </li>
    <li>
      <a href="../articles/calcED.html">Calculate similarity of faces</a>
    </li>
    <li>
      <a href="../articles/calcAsym.html">Calculate asymmetry of faces</a>
    </li>
    <li>
      <a href="../articles/overview.html">facefuns Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iholzleitner/facefuns/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="calcSD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="calcSD_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="calcSD_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculate sexual dimorphism of faces</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iholzleitner/facefuns/blob/master/vignettes/calcSD.Rmd"><code>vignettes/calcSD.Rmd</code></a></small>
      <div class="hidden name"><code>calcSD.Rmd</code></div>

    </div>

    
    
<p><strong>WORK IN PROGRESS</strong></p>
<p>This tutorial will explain how to calculate facial sexual dimorphism (SD) in a set of 2D faces, using (1) a vector method (REF) and (2) linear discriminant analysis.</p>
<p>[Explain what these are/how they differ, references etc.]</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iholzleitner/facefuns">facefuns</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div id="read-and-prep-landmark-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-and-prep-landmark-data" class="anchor"></a>Read and prep landmark data</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_to_tem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tem"</span>, package<span class="op">=</span><span class="st">"facefuns"</span><span class="op">)</span>
<span class="va">remove_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">104</span>, <span class="fl">116</span><span class="op">:</span><span class="fl">125</span>, <span class="fl">146</span><span class="op">:</span><span class="fl">158</span>, <span class="fl">159</span><span class="op">:</span><span class="fl">164</span>, <span class="fl">165</span><span class="op">:</span><span class="fl">170</span>, <span class="fl">171</span><span class="op">:</span><span class="fl">174</span>, <span class="fl">175</span><span class="op">:</span><span class="fl">179</span>, <span class="fl">184</span><span class="op">:</span><span class="fl">185</span><span class="op">)</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lmdata.html">read_lmdata</a></span><span class="op">(</span>lmdata <span class="op">=</span> <span class="va">path_to_tem</span>,
                    remove_points <span class="op">=</span> <span class="va">remove_points</span>,
                    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">shapedata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quickstart.html">quickstart</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,
                        pc_criterion <span class="op">=</span> <span class="st">"broken_stick"</span>,
                        plot_sample <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; The loaded data set contains 102 specimen, delineated with 132 2-D landmarks.</span>
<span class="co">#&gt; The broken_stick criterion was used to select 8 principal components.</span>
<span class="co">#&gt; Templates were rotated using "rotateC" after the GPA.</span></code></pre></div>
<p>In addition, we’ll also need to know which of the faces in our sample are female, and which are male.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   face_id face_age face_sex face_eth  </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;     </span>
<span class="co">#&gt; 1 001           24 female   white     </span>
<span class="co">#&gt; 2 002           24 female   white     </span>
<span class="co">#&gt; 3 003           38 female   white     </span>
<span class="co">#&gt; 4 004           30 male     white     </span>
<span class="co">#&gt; 5 005           28 male     east_asian</span>
<span class="co">#&gt; 6 006           31 female   west_asian</span></code></pre></div>
</div>
<div id="vector-scores-calcshapevs" class="section level2">
<h2 class="hasAnchor">
<a href="#vector-scores-calcshapevs" class="anchor"></a>Vector scores: <code>calc(shape)VS</code>
</h2>
<p><code><a href="../reference/calcVS.html">facefuns::calcVS</a></code> calculates sexual dimorphism by computing an n-dimensional vector between the average female and the average male shape, and then projecting each face onto this vector. Scores are scaled so that a score of 0 corresponds to the average female, and a score of 1 to the average male shape; a negative score, e.g., would thus indicate a hyperfeminine face.</p>
<p>You can use <code>calcVS</code> to calculate vector scores from a data frame or matrix of principal component scores (see <code><a href="../reference/calcVS.html">help(calcVS)</a></code>), or <code>calcShapeVS</code> to calculate them from the Procrustes-aligned templates in the quickstart output.</p>
<p><code>calcShapeVS</code> takes three arguments, all of which should be a data frame or matrix with specimen as rows, and PC scores as columns:</p>
<ul>
<li>
<code>quickstart_obj</code>: Output from <code><a href="../reference/quickstart.html">facefuns::quickstart</a></code>
</li>
<li>
<code>anchor1_index</code>: Vector specifying indices of faces that will constitute lower anchor point<br>
</li>
<li>
<code>anchor2_index</code>: Vector specifying indices of faces that will constitute upper anchor point</li>
</ul>
<p>We get the index of which faces in our array of Procrustes-aligned faces are female/male by testing which IDs have a corresponding entry in the info table for which sex == female/male</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fem_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^ID="</span>,<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%in%</span>
  <span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span><span class="op">]</span>

<span class="va">mal_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^ID="</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%in%</span>
  <span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_sex</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Now, we can run our function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcShapeVS.html">calcShapeVS</a></span><span class="op">(</span><span class="va">shapedata</span>, <span class="va">fem_i</span>, <span class="va">mal_i</span><span class="op">)</span></code></pre></div>
<p><code>calc(Shape)VS</code> will return a tibble that has two columns, <code>id</code> and <code>VS</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_vector</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   id          VS</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 001   -1.06   </span>
<span class="co">#&gt; 2 002    0.00299</span>
<span class="co">#&gt; 3 003   -0.250  </span>
<span class="co">#&gt; 4 004    0.855  </span>
<span class="co">#&gt; 5 005    0.548  </span>
<span class="co">#&gt; 6 006    0.582</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, color<span class="op">=</span><span class="va">face_sex</span>, fill <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div id="note-calculating-vector-scores-within--and-out-of-set" class="section level3">
<h3 class="hasAnchor">
<a href="#note-calculating-vector-scores-within--and-out-of-set" class="anchor"></a>Note: calculating vector scores within- and out-of-set</h3>
<p>[explain you could also do this out-of-set; if your current sample is small, but you have a larger sample at hand that was delineated with the same landmarks or a compatible sub-/superset, you could use that bigger sample to build shape PCA model and construct vector, and then project faces from smaller sample onto it]</p>
</div>
<div id="note-calculating-sexual-dimorphism-from-symmetrized-faces" class="section level3">
<h3 class="hasAnchor">
<a href="#note-calculating-sexual-dimorphism-from-symmetrized-faces" class="anchor"></a>Note: calculating sexual dimorphism from symmetrized faces</h3>
<p>[References and critical notes - basically, 2D images are strongly affected by head posture, which is reflected in the fact that in 2D sets, the first two principal components usually show shape associated with heads being tilted up/down, or heads being turned left/right. We can’t do much about up/down (plus shape differences associated with up/down overlaps with those of sexual dimorphism), but left/right COULD be “remedied” by symmetrizing faces.]</p>
<p>There are two ways to go about this: either just symmetrize templates before submitting them to quickstart (which has the added benefit that it’s very little fuss to plot the PCs on which the scores are based); or by using the option symmetrize in <code>calcShapeVS</code>.</p>
<p>Symmetrizing works by mirroring each landmark template, and calculating the mean between the original and mirrored template. After mirroring, the landmarks need to be relabeled - corresponding landmarks need to be on the same line in each template, but what used to be point 0 (right pupil) in the original template, is point 1 (the left pupil) after mirroring.</p>
<p>Unfortunately, this information needs to be manually entered, and will very much depend on the landmark template you want to mirror! For the set of 132 landmarks used throughout the examples in <code>facefuns</code>, this info is stored in <code>mirr_lms</code>.</p>
<p>If <code>symm=TRUE</code>, <code>calcShapeVS</code> will first symmetrize the faces, re-conduct a GPA and PCA on these symmetrized templates, and then run <code>calcVS</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mirr_lms"</span><span class="op">)</span>

<span class="va">sd_vector_symm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcShapeVS.html">calcShapeVS</a></span><span class="op">(</span><span class="va">shapedata</span>, <span class="va">fem_i</span>, <span class="va">mal_i</span>, symm <span class="op">=</span> <span class="cn">TRUE</span>, mirr_lms <span class="op">=</span> <span class="va">mirr_lms</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_vector_symm</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   id        VS</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 001   -0.990</span>
<span class="co">#&gt; 2 002    0.121</span>
<span class="co">#&gt; 3 003   -0.205</span>
<span class="co">#&gt; 4 004    0.748</span>
<span class="co">#&gt; 5 005    0.555</span>
<span class="co">#&gt; 6 006    0.526</span>

<span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector_symm</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, color<span class="op">=</span><span class="va">face_sex</span>, fill <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="discriminant-scores-calcds" class="section level2">
<h2 class="hasAnchor">
<a href="#discriminant-scores-calcds" class="anchor"></a>Discriminant scores: <code>calcDS</code>
</h2>
<p>Another way to calculate sexual dimorphism is by employing a linear discriminant analyses to predict group membership.</p>
<p><code>calcVS</code> first conducts a (forward) stepwise variable selection and then carries out a linear discriminant analysis. It takes two arguments:</p>
<ul>
<li>
<code>data</code>: A data frame or matrix with specimen as rows, and PCs as columns. Can also contain an additional column that defines group membership.</li>
<li>
<code>group_info</code>: Either a data frame with two columns (col 1 = id matching the rownames in data; col 2 = group), or a single numeric value indexing the column in data that contains group membership info</li>
</ul>
<p>For this example, we’ll specify group membership with a separate data frame.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">group_info</span> <span class="op">&lt;-</span> <span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">face_id</span>, <span class="va">face_sex</span><span class="op">)</span>

<span class="va">sd_discrim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcDS.html">calcDS</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">pc_scores</span>, group_info <span class="op">=</span> <span class="va">group_info</span><span class="op">)</span></code></pre></div>
<p>Like <code>calcVS</code>, <code>calcDS</code> will return a tibble that has two columns, in this case <code>id</code> and <code>DS</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_discrim</span><span class="op">)</span></code></pre></div>
</div>
<div id="compare-vector-and-discriminant-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-vector-and-discriminant-scores" class="anchor"></a>Compare vector and discriminant scores</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compareSD</span> <span class="op">&lt;-</span> <span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_discrim</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span>

<span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">face_sex</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VS</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,
                   mean_ds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   face_sex mean_vs mean_ds</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 female         0   -1.45</span>
<span class="co">#&gt; 2 male           1    1.34</span>

<span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, y <span class="op">=</span> <span class="va">DS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, color <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div id="visualize-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-differences" class="anchor"></a>Visualize differences</h3>
<p>Pull lowest- and highest-scoring individuals and plot difference between them</p>
<p>[Tidy this up!!]</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lo_vs</span> <span class="op">&lt;-</span> <span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">VS</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">face_id</span><span class="op">)</span>

<span class="va">lo_ds</span> <span class="op">&lt;-</span> <span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">DS</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">face_id</span><span class="op">)</span>

<span class="va">hi_vs</span> <span class="op">&lt;-</span> <span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">VS</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">face_id</span><span class="op">)</span>

<span class="va">hi_ds</span> <span class="op">&lt;-</span> <span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">DS</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">face_id</span><span class="op">)</span>

<span class="va">lo_vs_faces</span> <span class="op">&lt;-</span> <span class="fu">geomorph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/mshape.html">mshape</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">[</span>,,<span class="va">lo_vs</span><span class="op">]</span><span class="op">)</span>
<span class="va">lo_ds_faces</span> <span class="op">&lt;-</span> <span class="fu">geomorph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/mshape.html">mshape</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">[</span>,,<span class="va">lo_ds</span><span class="op">]</span><span class="op">)</span>
<span class="va">hi_vs_faces</span> <span class="op">&lt;-</span> <span class="fu">geomorph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/mshape.html">mshape</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">[</span>,,<span class="va">hi_vs</span><span class="op">]</span><span class="op">)</span>
<span class="va">hi_ds_faces</span> <span class="op">&lt;-</span> <span class="fu">geomorph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/mshape.html">mshape</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">array</span><span class="op">[</span>,,<span class="va">hi_ds</span><span class="op">]</span><span class="op">)</span>

<span class="va">plotl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lo_vs_faces</span>, <span class="va">lo_ds_faces</span>, <span class="va">hi_vs_faces</span>, <span class="va">hi_ds_faces</span><span class="op">)</span>
<span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">shapedata</span><span class="op">$</span><span class="va">average</span>

<span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rapply.html">rapply</a></span><span class="op">(</span><span class="va">plotl</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="fu">geomorph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/plotRefToTarget.html">plotRefToTarget</a></span><span class="op">(</span><span class="va">ref</span>, <span class="va">x</span>, mag<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">}</span>
  <span class="op">}</span>, how <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="va"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">plot_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Top left: low vector score, top right: low discriminant score Bottom left: high vector score, bottom right: high discriminant score</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iris J Holzleitner, Lisa M DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
