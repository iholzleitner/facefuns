<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate sexual dimorphism of faces • facefuns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calculate sexual dimorphism of faces">
<meta property="og:description" content="facefuns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">facefuns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/facefuns.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calcSD.html">Calculate sexual dimorphism of faces</a>
    </li>
    <li>
      <a href="../articles/calcED.html">Calculate similarity of faces</a>
    </li>
    <li>
      <a href="../articles/calcAsym.html">Calculate asymmetry of faces</a>
    </li>
    <li>
      <a href="../articles/intro3d.html">Working with 3D meshes</a>
    </li>
    <li>
      <a href="../articles/overview.html">facefuns Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iholzleitner/facefuns/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="calcSD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculate sexual dimorphism of faces</h1>
            
            <h4 class="date">2021-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/iholzleitner/facefuns/blob/master/vignettes/calcSD.Rmd"><code>vignettes/calcSD.Rmd</code></a></small>
      <div class="hidden name"><code>calcSD.Rmd</code></div>

    </div>

    
    
<p><strong>WORK IN PROGRESS</strong></p>
<p>This tutorial will explain how to calculate facial sexual dimorphism (SD) in a set of 2D faces, using a <a href="#vs">vector method</a> (e.g.,<span class="citation"><sup>[<a href="#ref-holzleitner2014" role="doc-biblioref">1</a>–<a href="#ref-valenzano2006" role="doc-biblioref">3</a>]</sup></span>) and <a href="#ds">linear discriminant analysis</a> (e.g.,<span class="citation"><sup>[<a href="#ref-scott2010" role="doc-biblioref">4</a>]</sup></span>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iholzleitner/facefuns">facefuns</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div id="read-and-prep-landmark-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-and-prep-landmark-data" class="anchor"></a>Read and prep landmark data</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_to_tem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tem"</span>, package<span class="op">=</span><span class="st">"facefuns"</span><span class="op">)</span>
<span class="va">remove_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">104</span>, <span class="fl">116</span><span class="op">:</span><span class="fl">125</span>, <span class="fl">146</span><span class="op">:</span><span class="fl">158</span>, <span class="fl">159</span><span class="op">:</span><span class="fl">164</span>, <span class="fl">165</span><span class="op">:</span><span class="fl">170</span>, <span class="fl">171</span><span class="op">:</span><span class="fl">174</span>, <span class="fl">175</span><span class="op">:</span><span class="fl">179</span>, <span class="fl">184</span><span class="op">:</span><span class="fl">185</span><span class="op">)</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lmdata.html">read_lmdata</a></span><span class="op">(</span>lmdata <span class="op">=</span> <span class="va">path_to_tem</span>,
                    remove_points <span class="op">=</span> <span class="va">remove_points</span>,
                    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">shapedata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/facefuns.html">facefuns</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,
                        pc_criterion <span class="op">=</span> <span class="st">"broken_stick"</span>,
                        plot_sample <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; All landmarks were used in analyses.</span>
<span class="co">#&gt; The loaded data set contains 102 specimen, delineated with 132 2-D landmarks.</span>
<span class="co">#&gt; The broken_stick criterion was used to select 8 principal components.</span>
<span class="co">#&gt; Templates were rotated using "rotateC" after the GPA.</span></code></pre></div>
<p>In addition, we’ll also need to know which of the faces in our sample are female, and which are male.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   face_id face_age face_sex face_eth  </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;     </span>
<span class="co">#&gt; 1 001           24 female   white     </span>
<span class="co">#&gt; 2 002           24 female   white     </span>
<span class="co">#&gt; 3 003           38 female   white     </span>
<span class="co">#&gt; 4 004           30 male     white     </span>
<span class="co">#&gt; 5 005           28 male     east_asian</span>
<span class="co">#&gt; 6 006           31 female   west_asian</span></code></pre></div>
</div>
<div id="vector-scores-calc_shapevs" class="section level2">
<h2 class="hasAnchor">
<a href="#vector-scores-calc_shapevs" class="anchor"></a>1. Vector scores: <code id="vs">calc_(shape)vs</code>
</h2>
<p><code><a href="../reference/calc_vs.html">facefuns::calc_vs</a></code> calculates sexual dimorphism by computing an n-dimensional vector between the average female and the average male shape, and then projecting each face onto this vector. Scores are scaled so that a score of 0 corresponds to the average female, and a score of 1 to the average male shape; a negative score, e.g., would thus indicate a hyperfeminine face.</p>
<p>You can use <code>calc_vs</code> to calculate vector scores from a data frame or matrix of principal component scores (see <code><a href="../reference/calc_vs.html">help(calc_vs)</a></code>), or <code>calc_shapevs</code> to calculate them from the Procrustes-aligned templates in the facefuns output.</p>
<p><code>calc_shapevs</code> takes three arguments, all of which should be a data frame or matrix with specimen as rows, and PC scores as columns:</p>
<ul>
<li>
<code>facefuns_obj</code>: Output from <code><a href="../reference/facefuns.html">facefuns::facefuns</a></code>
</li>
<li>
<code>anchor1_index</code>: Vector specifying indices of faces that will constitute lower anchor point<br>
</li>
<li>
<code>anchor2_index</code>: Vector specifying indices of faces that will constitute upper anchor point</li>
</ul>
<p>We get the index of which faces in our array of Procrustes-aligned faces are female/male by testing which IDs have a corresponding entry in the info table for which sex == female/male</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fem_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^ID="</span>,<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">aligned</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%in%</span>
  <span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span><span class="op">]</span>

<span class="va">mal_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^ID="</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">aligned</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%in%</span>
  <span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LondonSet_info</span><span class="op">$</span><span class="va">face_sex</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Now, we can run our function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_shapevs.html">calc_shapevs</a></span><span class="op">(</span><span class="va">shapedata</span>, <span class="va">fem_i</span>, <span class="va">mal_i</span><span class="op">)</span></code></pre></div>
<p><code>calc_(shape)vs</code> will return a tibble that has two columns, <code>id</code> and <code>VS</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_vector</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   id          VS</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 001   -1.06   </span>
<span class="co">#&gt; 2 002    0.00299</span>
<span class="co">#&gt; 3 003   -0.250  </span>
<span class="co">#&gt; 4 004    0.855  </span>
<span class="co">#&gt; 5 005    0.548  </span>
<span class="co">#&gt; 6 006    0.582</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, color<span class="op">=</span><span class="va">face_sex</span>, fill <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div id="note-calculating-vector-scores-within--and-out-of-set" class="section level3">
<h3 class="hasAnchor">
<a href="#note-calculating-vector-scores-within--and-out-of-set" class="anchor"></a>Note: calculating vector scores within- and out-of-set</h3>
<p>If your current sample is small, but you have a larger sample at hand that was delineated with the same landmarks or a compatible sub-/superset, you could use that bigger sample to build your shape PCA model and construct the sexual dimorphism vector, and then project faces from the smaller sample onto that vector. You can find an example <a href="https://osf.io/s7c2z/">here</a> (to be updated and added to this vignette in the future).</p>
</div>
<div id="note-calculating-sexual-dimorphism-from-symmetrized-faces" class="section level3">
<h3 class="hasAnchor">
<a href="#note-calculating-sexual-dimorphism-from-symmetrized-faces" class="anchor"></a>Note: calculating sexual dimorphism from symmetrized faces</h3>
<p>Two-dimensional images are strongly affected by head posture, which is reflected in the fact that in 2D sets, the first principal components usually show shape associated with heads being tilted up/down, or heads being turned left/right. While it is not possible to “correct” for up/down head postures (plus shape differences associated with an upward-/downward-tilt overlap with those of sexual dimorphism), slight asymmetries due to a left/right tilt <em>could</em> be “remedied” by symmetrizing faces.</p>
<p>You could either symmetrize templates before submitting them to facefuns (using <code><a href="../reference/symm_templates.html">facefuns::symm_templates</a></code>) which has the added benefit that it’s very little fuss to plot the PCs on which the scores are based; or you could do so by using the option <code>symm = TRUE</code> in <code>calc_shapevs</code>.</p>
<p>Symmetrizing works by mirroring each landmark template, and calculating the mean between the original and mirrored template. After mirroring, the landmarks need to be relabeled - what used to be point 0 (right pupil) in the original template, is point 1 (the left pupil) after mirroring.</p>
<p>Unfortunately, this information needs to be manually entered, and will very much depend on the landmark template you want to mirror. For the set of 132 landmarks used throughout the examples in <code>facefuns</code>, this info is stored in <code>mirroredlandmarks</code>.</p>
<p>If <code>symm = TRUE</code>, <code>calc_shapevs</code> will first symmetrize the faces, re-conduct a GPA and PCA on these symmetrized templates, and then run <code>calc_vs</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mirroredlandmarks"</span><span class="op">)</span>

<span class="va">sd_vector_symm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_shapevs.html">calc_shapevs</a></span><span class="op">(</span><span class="va">shapedata</span>, <span class="va">fem_i</span>, <span class="va">mal_i</span>, symm <span class="op">=</span> <span class="cn">TRUE</span>, mirroredlandmarks <span class="op">=</span> <span class="va">mirroredlandmarks</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_vector_symm</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   id        VS</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 001   -0.990</span>
<span class="co">#&gt; 2 002    0.121</span>
<span class="co">#&gt; 3 003   -0.205</span>
<span class="co">#&gt; 4 004    0.748</span>
<span class="co">#&gt; 5 005    0.555</span>
<span class="co">#&gt; 6 006    0.526</span>

<span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector_symm</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, color<span class="op">=</span><span class="va">face_sex</span>, fill <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="discriminant-scores-calc_ds" class="section level2">
<h2 class="hasAnchor">
<a href="#discriminant-scores-calc_ds" class="anchor"></a>2. Discriminant scores: <code id="ds">calc_ds</code>
</h2>
<p>Another way to calculate sexual dimorphism is by employing a linear discriminant analyses to predict group membership.</p>
<p><code>calc_ds</code> first conducts a (forward) stepwise variable selection and then carries out a linear discriminant analysis. It takes two arguments:</p>
<ul>
<li>
<code>data</code>: A data frame or matrix with specimen as rows, and PCs as columns. Can also contain an additional column that defines group membership.</li>
<li>
<code>group_info</code>: Either a data frame with two columns (col 1 = id matching the rownames in data; col 2 = group), or a single numeric value indexing the column in data that contains group membership info</li>
</ul>
<p>For this example, we’ll specify group membership with a separate data frame.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">group_info</span> <span class="op">&lt;-</span> <span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">face_id</span>, <span class="va">face_sex</span><span class="op">)</span>

<span class="va">sd_discrim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_ds.html">calc_ds</a></span><span class="op">(</span><span class="va">shapedata</span><span class="op">$</span><span class="va">pc_scores</span>, group_info <span class="op">=</span> <span class="va">group_info</span><span class="op">)</span></code></pre></div>
<p>Like <code>calc_vs</code>, <code>calc_ds</code> will return a tibble that has two columns, in this case <code>id</code> and <code>DS</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd_discrim</span><span class="op">)</span></code></pre></div>
</div>
<div id="compare-vector-and-discriminant-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-vector-and-discriminant-scores" class="anchor"></a>Compare vector and discriminant scores</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compareSD</span> <span class="op">&lt;-</span> <span class="va">LondonSet_info</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_vector</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sd_discrim</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"face_id"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span>

<span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">face_sex</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VS</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,
                   mean_ds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DS</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   face_sex mean_vs mean_ds</span>
<span class="co">#&gt; * &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 female         0   -1.45</span>
<span class="co">#&gt; 2 male           1    1.34</span>

<span class="va">compareSD</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VS</span>, y <span class="op">=</span> <span class="va">DS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">face_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, color <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="calcSD_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div id="visualize-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-differences" class="anchor"></a>Visualize differences</h3>
<p>Plot difference between lowest-scoring (top) and highest-scoring faces (bottom) on VS (left) and DS (right)</p>
<p><img src="calcSD_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-holzleitner2014">
<p>1. Holzleitner, I. J., Hunter, D. W., Tiddeman, B. P., Seck, A., Re, D. E., &amp; Perrett, D. I. (2014). Men’s facial masculinity: When (body) size matters. <em>Perception</em>, <em>43</em>, 1191–1202. <a href="https://doi.org/10.1068/P7673">https://doi.org/10.1068/P7673</a></p>
</div>
<div id="ref-komori2011">
<p>2. Komori, M., Kawamura, S., &amp; Ishihara, S. (2011). Multiple mechanisms in the perception of face gender: Effect of sex-irrelevant features. <em>Journal of Experimental Psychology-Human Perception and Performance</em>, <em>37</em>, 626–633. <a href="https://doi.org/10.1037/A0020369">https://doi.org/10.1037/A0020369</a></p>
</div>
<div id="ref-valenzano2006">
<p>3. Valenzano, D. R., Mennucci, A., Tartarelli, G., &amp; Cellerino, A. (2006). Shape analysis of female facial attractiveness. <em>Vision Research</em>, <em>46</em>, 1282–1291. <a href="https://doi.org/10.1016/j.visres.2005.10.024">https://doi.org/10.1016/j.visres.2005.10.024</a></p>
</div>
<div id="ref-scott2010">
<p>4. Scott, I. M. L., Pound, N., Stephen, I. D., Clark, A. P., &amp; Penton-Voak, I. S. (2010). Does masculinity matter? The contribution of masculine face shape to male attractiveness in humans. <em>PLoS ONE</em>, <em>5</em>. <a href="https://doi.org/10.1371/journal.pone.0013585">https://doi.org/10.1371/journal.pone.0013585</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iris J Holzleitner, Lisa M DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
