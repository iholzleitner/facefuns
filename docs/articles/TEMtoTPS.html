<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Converting Webmorph templates • facefuns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Converting Webmorph templates">
<meta property="og:description" content="facefuns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">facefuns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/TEMtoTPS.html">Converting Webmorph templates</a>
    </li>
    <li>
      <a href="../articles/calcED.html">Calculate similarity of faces</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iholzleitner/facefuns/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="TEMtoTPS_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="TEMtoTPS_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="TEMtoTPS_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Converting Webmorph templates</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iholzleitner/facefuns/blob/master/vignettes/TEMtoTPS.Rmd"><code>vignettes/TEMtoTPS.Rmd</code></a></small>
      <div class="hidden name"><code>TEMtoTPS.Rmd</code></div>

    </div>

    
    
<p><strong>NEEDS REWRITING AFTER FUNCTION CHANGES</strong></p>
<p>This tutorial will demonstrate how to convert Webmorph delineation files into the .tps format using the function <code>convertTEMtoTPS</code>. TPS is a commonly used file format in geometric morphometrics that can be read by packages such as <code>geomorph</code>.</p>
<p>This example uses the freely available <a href="https://figshare.com/articles/Face_Research_Lab_London_Set/5047666">Face Research Lab London Set</a>. Download delineation (and image) files for a set of 102 neutral images <a href="https://ndownloader.figshare.com/files/8541961">by clicking here</a>. Rename the downloaded folder to <code>tem</code> and put it in your working directory.</p>
<div id="the-converttemtotps-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-converttemtotps-function" class="anchor"></a>The <code>convertTEMtoTPS</code> function</h2>
<p>The function takes the following arguments:</p>
<ul>
<li><p><code>path_to_tem</code>: The path to the template files you want to convert</p></li>
<li><p><code>p</code>: The number of delineated landmarks</p></li>
<li><p><code>image_height</code>: Height of delineated images (in pixel)</p></li>
<li><p><code>del</code>: Any landmarks that should be removed during the conversion. Input can be single number or vector. If no value is provided, all landmarks are retained</p></li>
<li><p><code>path_to_tps</code>: Name and path of TPS file that will be created</p></li>
</ul>
<div id="path_to_tem" class="section level4">
<h4 class="hasAnchor">
<a href="#path_to_tem" class="anchor"></a><code>path_to_tem</code>
</h4>
<p>If you saved your template files in a sub directory of your working directory called <code>tem</code>, the path would simply be <code>path_to_tem = "./tem"</code>.</p>
</div>
<div id="p" class="section level4">
<h4 class="hasAnchor">
<a href="#p" class="anchor"></a><code>p</code>
</h4>
<p><code>p</code> is the number of landmarks. The default landmark template on Webmorph uses 189 landmarks, so for this example <code>p = 189</code>.</p>
</div>
<div id="image_height" class="section level4">
<h4 class="hasAnchor">
<a href="#image_height" class="anchor"></a><code>image_height</code>
</h4>
<p>Owing to its Java roots, Webmorph’s coordinate system has its origin on the top left. This means that if you try to import <code>.tem</code> files into other software such as R, templates will appear upside down.</p>
<p><code>convertTEMtoTPS</code> will flip Webmorph templates upside down by subtracting all y-coordinates from the image height in pixel. For the London Set, <code>image_height = 1350</code> pixels.</p>
</div>
<div id="del" class="section level4">
<h4 class="hasAnchor">
<a href="#del" class="anchor"></a><code>del</code>
</h4>
<p>You might not want to retain all of the landmarks the FRL default template uses for shape analyses. For example, the “halo” points are incredibly useful in creating visually sharp composite faces, but are not “fixed” landmarks (REF). For this example, we will remove the following landmarks:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Landmarks</th>
<th align="left">Number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Under eye</td>
<td align="left">44-49</td>
</tr>
<tr class="even">
<td align="left">Lower lip</td>
<td align="left">99-103</td>
</tr>
<tr class="odd">
<td align="left">Ears</td>
<td align="left">115-124</td>
</tr>
<tr class="even">
<td align="left">Halo</td>
<td align="left">145-157</td>
</tr>
<tr class="odd">
<td align="left">Smile lines</td>
<td align="left">158-163</td>
</tr>
<tr class="even">
<td align="left">Cheeks</td>
<td align="left">164-169</td>
</tr>
<tr class="odd">
<td align="left">Philtrum</td>
<td align="left">170-173</td>
</tr>
<tr class="even">
<td align="left">Chin</td>
<td align="left">174-178</td>
</tr>
<tr class="odd">
<td align="left">Neck</td>
<td align="left">183-184</td>
</tr>
</tbody>
</table>
<p>We can define which landmarks to exclude by creating a vector that contains the number of every landmark to be deleted. Note that Webmorph starts counting at 0 - you will have to add +1 to each landmark!</p>
<p>If deleting multiple landmarks, it’s easier to save all the landmarks in a vector instead of typing them into the function; for the current example, this would look like:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">del</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">104</span>, <span class="fl">116</span><span class="op">:</span><span class="fl">125</span>, <span class="fl">146</span><span class="op">:</span><span class="fl">158</span>, <span class="fl">159</span><span class="op">:</span><span class="fl">164</span>, <span class="fl">165</span><span class="op">:</span><span class="fl">170</span>, <span class="fl">171</span><span class="op">:</span><span class="fl">174</span>, <span class="fl">175</span><span class="op">:</span><span class="fl">179</span>, <span class="fl">184</span><span class="op">:</span><span class="fl">185</span><span class="op">)</span></pre></div>
</div>
<div id="path_to_output" class="section level4">
<h4 class="hasAnchor">
<a href="#path_to_output" class="anchor"></a><code>path_to_output</code>
</h4>
<p>Specifies where you want your TPS file saved, and how it should be named, e.g. <code>path_to_tps = "./LondonSet.tps"</code></p>
<p>Now, we have everything we need to convert our template files!</p>
</div>
<div id="run-function" class="section level3">
<h3 class="hasAnchor">
<a href="#run-function" class="anchor"></a>Run function</h3>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iholzleitner/facefuns">facefuns</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph">geomorph</a></span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="../reference/convertTEMtoTPS.html">convertTEMtoTPS</a></span><span class="op">(</span>path_to_tem <span class="op">=</span> <span class="st">"./tem"</span>,
                          p <span class="op">=</span> <span class="fl">189</span>,
                          image_height <span class="op">=</span> <span class="fl">1350</span>,
                          del <span class="op">=</span> <span class="va">del</span>,
                          path_to_tps <span class="op">=</span> <span class="st">"./LondonSet.tps"</span><span class="op">)</span></pre></div>
<p>We can check if everything worked the way we expected by using <code>geomorph</code> to load and plot data</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/readland.tps.html">readland.tps</a></span><span class="op">(</span><span class="st">"./LondonSet.tps"</span>, specID <span class="op">=</span> <span class="st">"ID"</span>, warnmsg <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/plotAllSpecimens.html">plotAllSpecimens</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></pre></div>
<p><img src="TEMtoTPS_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iris J Holzleitner, Lisa M DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
