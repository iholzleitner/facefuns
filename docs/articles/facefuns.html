<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to facefuns • facefuns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to facefuns">
<meta property="og:description" content="facefuns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">facefuns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/facefuns.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calcSD.html">Calculate sexual dimorphism of faces</a>
    </li>
    <li>
      <a href="../articles/calcED.html">Calculate similarity of faces</a>
    </li>
    <li>
      <a href="../articles/calcAsym.html">Calculate asymmetry of faces</a>
    </li>
    <li>
      <a href="../articles/intro3d.html">Working with 3D meshes</a>
    </li>
    <li>
      <a href="../articles/overview.html">facefuns Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iholzleitner/facefuns/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="facefuns_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to facefuns</h1>
            
            <h4 class="date">2021-02-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/iholzleitner/facefuns/blob/master/vignettes/facefuns.Rmd"><code>vignettes/facefuns.Rmd</code></a></small>
      <div class="hidden name"><code>facefuns.Rmd</code></div>

    </div>

    
    
<p><strong>WORK IN PROGRESS</strong></p>
<p>This package contains convenience functions for doing shape analyses of 2D and 3D face images in <code>R</code> (see also <a href="./overview.html">here</a>), as well as tutorials for some common analyses: calculating <a href="./calcSD.html">sexual dimorphism</a>, <a href="./calcED.html">facial similarity and averageness</a>, and <a href="./calcAsym.html">asymmetry</a>.</p>
<p>The following tutorial will provide a brief guide to loading 2D face data into <code>R</code>, Procrustes-aligning landmark templates and conducting a principal component analysis of shape using the package <code>geomorph</code>. It will conclude by introducing the function <code><a href="../reference/facefuns.html">facefuns::facefuns</a></code>, which will automatically conduct these steps and create outputs for use in subsequent analyses.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iholzleitner/facefuns">facefuns</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph">geomorph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<div id="read_lmdata" class="section level2">
<h2 class="hasAnchor">
<a href="#read_lmdata" class="anchor"></a><code>read_lmdata</code>
</h2>
<p>Steps for importing your delineated landmark templates into <code>R</code> will vary depending on the software you used to delineate and the <code>R</code> package(s) you want to use.</p>
<p>For this tutorial, we will work with the CC-BY licensed <a href="https://figshare.com/articles/Face_Research_Lab_London_Set/5047666">Face Research London Set</a>. This is a set of 102 faces that were delineated with the standard Face Research Lab (FRL) template of 189 points.</p>
<p>We will use <code><a href="../reference/read_lmdata.html">facefuns::read_lmdata</a></code> to read the template files.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_to_tem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tem"</span>, package<span class="op">=</span><span class="st">"facefuns"</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lmdata.html">read_lmdata</a></span><span class="op">(</span>lmdata <span class="op">=</span> <span class="va">path_to_tem</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>As you can see, <code>read_shapedata</code> will by default plot the loaded data. Use <code>plot = FALSE</code> to turn off plotting.</p>
<p>You might not want to retain all of the standard template’s 189 landmarks for shape analyses. For this example, we will remove the following landmarks:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Landmarks</th>
<th align="left">Number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Under eye</td>
<td align="left">44-49</td>
</tr>
<tr class="even">
<td align="left">Lower lip</td>
<td align="left">99-103</td>
</tr>
<tr class="odd">
<td align="left">Ears</td>
<td align="left">115-124</td>
</tr>
<tr class="even">
<td align="left">Halo</td>
<td align="left">145-157</td>
</tr>
<tr class="odd">
<td align="left">Smile lines</td>
<td align="left">158-163</td>
</tr>
<tr class="even">
<td align="left">Cheeks</td>
<td align="left">164-169</td>
</tr>
<tr class="odd">
<td align="left">Philtrum</td>
<td align="left">170-173</td>
</tr>
<tr class="even">
<td align="left">Chin</td>
<td align="left">174-178</td>
</tr>
<tr class="odd">
<td align="left">Neck</td>
<td align="left">183-184</td>
</tr>
</tbody>
</table>
<p>We can define which landmarks to exclude by creating a vector that contains the number of every landmark to be deleted. Note that Webmorph starts counting at 0 - you will have to add +1 to each landmark!</p>
<p>If deleting multiple landmarks, it’s easier to save them all into a vector; for the current example, this would look like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">remove_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">104</span>, <span class="fl">116</span><span class="op">:</span><span class="fl">125</span>, <span class="fl">146</span><span class="op">:</span><span class="fl">158</span>, <span class="fl">159</span><span class="op">:</span><span class="fl">164</span>, <span class="fl">165</span><span class="op">:</span><span class="fl">170</span>, <span class="fl">171</span><span class="op">:</span><span class="fl">174</span>, <span class="fl">175</span><span class="op">:</span><span class="fl">179</span>, <span class="fl">184</span><span class="op">:</span><span class="fl">185</span><span class="op">)</span></code></pre></div>
<p>Let’s read in the template files again, but this time we will remove the points we decided to eliminate:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_lmdata.html">read_lmdata</a></span><span class="op">(</span>lmdata <span class="op">=</span> <span class="va">path_to_tem</span>,
                       remove_points <span class="op">=</span> <span class="va">remove_points</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The black dots show the sample average, the gray points represent individual faces. As you can see, there is a lot of “noise” in the individual data - some of this variation will be due to</p>
<ul>
<li><p>differences in the <strong>size</strong> of delineated faces, e.g., some peoples’ faces might just be genuinely bigger, but it could also they were slightly closer to the camera;</p></li>
<li><p>their <strong>position</strong> on screen, e.g., some people’s faces might have been a bit more in the center of the captured image than others;</p></li>
<li><p>and their <strong>rotation</strong>, e.g., some people might have been tilting their face slightly to the left or right</p></li>
</ul>
<p>We are not interested in that sort of variation, but seek to eliminate it - Generalized Procrustes Analysis does exactly that!</p>
</div>
<div id="gpa" class="section level2">
<h2 class="hasAnchor">
<a href="#gpa" class="anchor"></a>GPA</h2>
<p>We’ll use <code>geomporph::gpagen</code> to Procrustes-align our data. Check out <code><a href="https://rdrr.io/pkg/geomorph/man/gpagen.html">help(gpagen)</a></code> for details and plenty of references!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_gpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/gpagen.html">gpagen</a></span><span class="op">(</span><span class="va">data</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>The aligned coordinates are stored in <code>data_gpa$coords</code>. Let’s plot one of the aligned faces.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data_gpa</span><span class="op">$</span><span class="va">coords</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The GPA will sometimes rotate landmark templates, but this can be easily fixed by rotating them back into the right position.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_aligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/rotate.coords.html">rotate.coords</a></span><span class="op">(</span><span class="va">data_gpa</span><span class="op">$</span><span class="va">coords</span>,
                              type <span class="op">=</span> <span class="st">"rotateC"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data_aligned</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Better. Let’s have another look at the whole sample again.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/plotAllSpecimens.html">plotAllSpecimens</a></span><span class="op">(</span><span class="va">data_aligned</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Much less messy! What we are left with after the GPA is actual <strong><em>shape</em></strong> data - data that is free of variation due to differences in size, location and orientation between individual subjects.</p>
</div>
<div id="shape-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#shape-pca" class="anchor"></a>Shape PCA</h2>
<p>You might want to explore which shape dimensions explain the most variance in your data. Or, you might just be keen to get out principal component scores for each face for use in subsequent analyses.</p>
<p>The <code>geomorph</code> function for conducting a shape PCA is <code>gm.prcomp</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pca_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/gm.prcomp.html">gm.prcomp</a></span><span class="op">(</span><span class="va">data_aligned</span><span class="op">)</span>
<span class="co"># summary(pca_output)</span></code></pre></div>
<p><code><a href="https://rdrr.io/r/base/summary.html">summary(pca_output)</a></code> will return a list of <em>all</em> principal components. That is usually not what we want. Instead, we will use <code><a href="../reference/select_pcs.html">facefuns::select_pcs</a></code> to decide which PCs we would like to retain for subsequent analyses.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">london_pcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_pcs.html">select_pcs</a></span><span class="op">(</span><span class="va">pca_output</span><span class="op">)</span></code></pre></div>
<p><code>select_pcs</code> returns a list of principal components as chosen by one of three methods. It defaults to the most conservative “broken_stick” method. Other methods are “Kaiser_Guttman” (retains PCs with eigenvalues greater than the mean eigenvalue) and “total_variance” (retains PCs explaining at least total_var variance). It returns three items: the number of selected PCs (<code>london_pcs$n</code>), their importance (<code>london_pcs$selected</code>) and the criterion that was used to choose PCs (<code>london_pcs$method</code>). The London Set has 8 selected PCs; the first three PCs explain 36.2%, 11.1% and 6.7% of variance, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">london_pcs</span><span class="op">$</span><span class="va">selected</span>
<span class="co">#&gt;        SD Variance Cum Var</span>
<span class="co">#&gt; PC1 0.046    0.362   0.362</span>
<span class="co">#&gt; PC2 0.026    0.111   0.474</span>
<span class="co">#&gt; PC3 0.020    0.067   0.541</span>
<span class="co">#&gt; PC4 0.018    0.058   0.599</span>
<span class="co">#&gt; PC5 0.018    0.056   0.655</span>
<span class="co">#&gt; PC6 0.017    0.050   0.705</span>
<span class="co">#&gt; PC7 0.014    0.033   0.739</span>
<span class="co">#&gt; PC8 0.013    0.027   0.766</span></code></pre></div>
<p>The principal component scores for each face are stored in <code>pca_output$x</code>. To save them for any subsequent analyses you might want to do, we could use the following code:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LondonSet_scores</span> <span class="op">&lt;-</span> <span class="va">pca_output</span><span class="op">$</span><span class="va">x</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># tidy colnames</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"Comp"</span>, <span class="st">"PC"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># re-add IDs</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>.before <span class="op">=</span> <span class="fl">1</span>,
                     id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^ID="</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">london_pcs</span><span class="op">$</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>What do the shape PCs for the London Set look like? You can use <code><a href="https://rdrr.io/pkg/geomorph/man/plotRefToTarget.html">geomorph::plotRefToTarget</a></code> function to visualize differences, e.g., between the average face and the sample min and max values on individual PCs.</p>
<p>We will first define the reference face (here, the sample average) and then plot the difference to the sample min and max on PC1.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/mshape.html">mshape</a></span><span class="op">(</span><span class="va">data_aligned</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/plotRefToTarget.html">plotRefToTarget</a></span><span class="op">(</span><span class="va">ref</span>, <span class="va">pca_output</span><span class="op">$</span><span class="va">shapes</span><span class="op">$</span><span class="va">shapes.comp1</span><span class="op">$</span><span class="va">min</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/plotRefToTarget.html">plotRefToTarget</a></span><span class="op">(</span><span class="va">ref</span>, <span class="va">pca_output</span><span class="op">$</span><span class="va">shapes</span><span class="op">$</span><span class="va">shapes.comp1</span><span class="op">$</span><span class="va">max</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div id="facefuns" class="section level2">
<h2 class="hasAnchor">
<a href="#facefuns" class="anchor"></a><code>facefuns</code>
</h2>
<p><code>facefuns</code> is a convenience function for doing all of the above in one step.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shapedata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/facefuns.html">facefuns</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,
                        pc_criterion <span class="op">=</span> <span class="st">"broken_stick"</span>,
                        plot_sample <span class="op">=</span> <span class="cn">TRUE</span>,
                        auto_rotate <span class="op">=</span> <span class="cn">TRUE</span>,
                        quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<pre><code>#&gt; The loaded data set contains 102 specimen, delineated with 132 2-D landmarks.
#&gt; The broken_stick criterion was used to select 8 principal components.
#&gt; Templates were rotated using "rotateC" after the GPA.</code></pre>
<p><code>facefuns</code> returns a list with the following elements:</p>
<ul>
<li>
<code>array</code>: Procrustes-aligned data as three-dimensional array<br>
</li>
<li>
<code>matrix</code>: Procrustes-aligned data as two-dimensional matrix [MAKE OPTIONAL?]<br>
</li>
<li>
<code>average</code>: sample average<br>
</li>
<li>
<code>pc_info</code>:
<ul>
<li>
<code>selected</code>: contains elements <code>SD</code>, <code>Variance</code>, and <code>Cum Var</code>
</li>
<li>
<code>n</code>: number of selected PCs</li>
<li>
<code>method</code>: criterion used to select PCs<br>
</li>
</ul>
</li>
<li>
<code>pc_scores</code>: principal component scores<br>
</li>
<li>
<code>pc_plot</code>: PCs for plotting</li>
<li>
<code>summary</code>: List of key descriptives</li>
</ul>
<div id="plot_2dpcs" class="section level3">
<h3 class="hasAnchor">
<a href="#plot_2dpcs" class="anchor"></a><code>plot_2dpcs</code>
</h3>
<p>By default, <code>facefuns</code> will create all selected PCs at plus and minus 3 standard deviations. These can again be plotted using <code>plotRefToTarget</code> or using <code>plot_2dpcs</code>. Note that while <code>plotRefToTarget</code> is based on the sample range of a specific PC, <code>plot_2dpcs</code> is based on units of standard deviation (see also <code><a href="../reference/plot_2dpcs.html">help(plot_2dpcs)</a></code>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_2dpcs.html">plot_2dpcs</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">shapedata</span><span class="op">$</span><span class="va">pc_plot</span>,
          ref <span class="op">=</span> <span class="va">shapedata</span><span class="op">$</span><span class="va">average</span>,
          which_pcs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="facefuns_files/figure-html/unnamed-chunk-15-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iris J Holzleitner, Lisa M DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
